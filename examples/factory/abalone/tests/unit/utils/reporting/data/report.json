{"definition": {"Version": "2020-12-01", "Metadata": {}, "Parameters": [{"Name": "ProcessingInstanceCount", "Type": "Integer", "DefaultValue": 1}, {"Name": "TrainingInstanceType", "Type": "String", "DefaultValue": "ml.m5.xlarge"}, {"Name": "ModelApprovalStatus", "Type": "String", "DefaultValue": "PendingManualApproval"}, {"Name": "InputData", "Type": "String", "DefaultValue": "s3://sagemaker-eu-west-1-885983317836/abalone/abalone-dataset.csv"}, {"Name": "BatchData", "Type": "String", "DefaultValue": "s3://sagemaker-eu-west-1-885983317836/abalone/abalone-dataset-batch"}, {"Name": "MseThreshold", "Type": "Float", "DefaultValue": 6.0}], "PipelineExperimentConfig": {"ExperimentName": {"Get": "Execution.PipelineName"}, "TrialName": {"Get": "Execution.PipelineExecutionId"}}, "Steps": [{"Name": "AbaloneProcess", "Type": "Processing", "Arguments": {"ProcessingResources": {"ClusterConfig": {"InstanceType": "ml.m5.xlarge", "InstanceCount": {"Get": "Parameters.ProcessingInstanceCount"}, "VolumeSizeInGB": 30}}, "AppSpecification": {"ImageUri": "141502667606.dkr.ecr.eu-west-1.amazonaws.com/sagemaker-scikit-learn:0.23-1-cpu-py3", "ContainerEntrypoint": ["python3", "/opt/ml/processing/input/code/preprocessing.py"]}, "RoleArn": "arn:aws:iam::885983317836:role/service-role/AmazonSageMaker-ExecutionRole-20221012T104445", "ProcessingInputs": [{"InputName": "input-1", "AppManaged": false, "S3Input": {"S3Uri": {"Get": "Parameters.InputData"}, "LocalPath": "/opt/ml/processing/input", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "code", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-eu-west-1-885983317836/sklearn-abalone-process-2022-12-02-21-04-06-122/input/code/preprocessing.py", "LocalPath": "/opt/ml/processing/input/code", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}], "ProcessingOutputConfig": {"Outputs": [{"OutputName": "train", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-eu-west-1-885983317836/sklearn-abalone-process-2022-12-02-21-04-06-122/output/train", "LocalPath": "/opt/ml/processing/train", "S3UploadMode": "EndOfJob"}}, {"OutputName": "validation", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-eu-west-1-885983317836/sklearn-abalone-process-2022-12-02-21-04-06-122/output/validation", "LocalPath": "/opt/ml/processing/validation", "S3UploadMode": "EndOfJob"}}, {"OutputName": "test", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-eu-west-1-885983317836/sklearn-abalone-process-2022-12-02-21-04-06-122/output/test", "LocalPath": "/opt/ml/processing/test", "S3UploadMode": "EndOfJob"}}]}}}, {"Name": "AbaloneTrain", "Type": "Training", "Arguments": {"AlgorithmSpecification": {"TrainingInputMode": "File", "TrainingImage": "141502667606.dkr.ecr.eu-west-1.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3"}, "OutputDataConfig": {"S3OutputPath": "s3://sagemaker-eu-west-1-885983317836/AbaloneTrain"}, "StoppingCondition": {"MaxRuntimeInSeconds": 86400}, "ResourceConfig": {"VolumeSizeInGB": 30, "InstanceCount": 1, "InstanceType": {"Get": "Parameters.TrainingInstanceType"}}, "RoleArn": "arn:aws:iam::885983317836:role/service-role/AmazonSageMaker-ExecutionRole-20221012T104445", "InputDataConfig": [{"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Get": "Steps.AbaloneProcess.ProcessingOutputConfig.Outputs['train'].S3Output.S3Uri"}, "S3DataDistributionType": "FullyReplicated"}}, "ContentType": "text/csv", "ChannelName": "train"}, {"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Get": "Steps.AbaloneProcess.ProcessingOutputConfig.Outputs['validation'].S3Output.S3Uri"}, "S3DataDistributionType": "FullyReplicated"}}, "ContentType": "text/csv", "ChannelName": "validation"}], "HyperParameters": {"objective": "reg:linear", "num_round": "50", "max_depth": "5", "eta": "0.2", "gamma": "4", "min_child_weight": "6", "subsample": "0.7"}, "ProfilerRuleConfigurations": [{"RuleConfigurationName": "ProfilerReport-1670015047", "RuleEvaluatorImage": "929884845733.dkr.ecr.eu-west-1.amazonaws.com/sagemaker-debugger-rules:latest", "RuleParameters": {"rule_to_invoke": "ProfilerReport"}}], "ProfilerConfig": {"S3OutputPath": "s3://sagemaker-eu-west-1-885983317836/AbaloneTrain"}}}, {"Name": "AbaloneEval", "Type": "Processing", "Arguments": {"ProcessingResources": {"ClusterConfig": {"InstanceType": "ml.m5.xlarge", "InstanceCount": 1, "VolumeSizeInGB": 30}}, "AppSpecification": {"ImageUri": "141502667606.dkr.ecr.eu-west-1.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3", "ContainerEntrypoint": ["python3", "/opt/ml/processing/input/code/evaluation.py"]}, "RoleArn": "arn:aws:iam::885983317836:role/service-role/AmazonSageMaker-ExecutionRole-20221012T104445", "ProcessingInputs": [{"InputName": "input-1", "AppManaged": false, "S3Input": {"S3Uri": {"Get": "Steps.AbaloneTrain.ModelArtifacts.S3ModelArtifacts"}, "LocalPath": "/opt/ml/processing/model", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "input-2", "AppManaged": false, "S3Input": {"S3Uri": {"Get": "Steps.AbaloneProcess.ProcessingOutputConfig.Outputs['test'].S3Output.S3Uri"}, "LocalPath": "/opt/ml/processing/test", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}, {"InputName": "code", "AppManaged": false, "S3Input": {"S3Uri": "s3://sagemaker-eu-west-1-885983317836/script-abalone-eval-2022-12-02-21-04-07-180/input/code/evaluation.py", "LocalPath": "/opt/ml/processing/input/code", "S3DataType": "S3Prefix", "S3InputMode": "File", "S3DataDistributionType": "FullyReplicated", "S3CompressionType": "None"}}], "ProcessingOutputConfig": {"Outputs": [{"OutputName": "evaluation", "AppManaged": false, "S3Output": {"S3Uri": "s3://sagemaker-eu-west-1-885983317836/script-abalone-eval-2022-12-02-21-04-07-180/output/evaluation", "LocalPath": "/opt/ml/processing/evaluation", "S3UploadMode": "EndOfJob"}}]}}, "DependsOn": ["AbaloneTrain"], "PropertyFiles": [{"PropertyFileName": "EvaluationReport", "OutputName": "evaluation", "FilePath": "evaluation.json"}]}, {"Name": "AbaloneMSECond", "Type": "Condition", "Arguments": {"Conditions": [{"Type": "LessThanOrEqualTo", "LeftValue": {"Std:JsonGet": {"PropertyFile": {"Get": "Steps.AbaloneEval.PropertyFiles.EvaluationReport"}, "Path": "regression_metrics.mse.value"}}, "RightValue": {"Get": "Parameters.MseThreshold"}}], "IfSteps": [{"Name": "AbaloneRegisterModel-RegisterModel", "Type": "RegisterModel", "Arguments": {"ModelPackageGroupName": "AbaloneMLOps2GroupName", "ModelMetrics": {"ModelQuality": {"Statistics": {"ContentType": "application/json", "S3Uri": "s3://sagemaker-eu-west-1-885983317836/script-abalone-eval-2022-12-02-21-04-07-180/output/evaluation/evaluation.json"}}, "Bias": {}, "Explainability": {}}, "InferenceSpecification": {"Containers": [{"Image": "141502667606.dkr.ecr.eu-west-1.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3", "Environment": {}, "ModelDataUrl": {"Get": "Steps.AbaloneTrain.ModelArtifacts.S3ModelArtifacts"}}], "SupportedContentTypes": ["text/csv"], "SupportedResponseMIMETypes": ["text/csv"], "SupportedRealtimeInferenceInstanceTypes": ["ml.t2.medium", "ml.m5.xlarge"], "SupportedTransformInstanceTypes": ["ml.m5.xlarge"]}, "ModelApprovalStatus": {"Get": "Parameters.ModelApprovalStatus"}}}, {"Name": "AbaloneCreateModel-CreateModel", "Type": "Model", "Arguments": {"ExecutionRoleArn": "arn:aws:iam::885983317836:role/service-role/AmazonSageMaker-ExecutionRole-20221012T104445", "PrimaryContainer": {"Image": "141502667606.dkr.ecr.eu-west-1.amazonaws.com/sagemaker-xgboost:1.0-1-cpu-py3", "Environment": {}, "ModelDataUrl": {"Get": "Steps.AbaloneTrain.ModelArtifacts.S3ModelArtifacts"}}}}, {"Name": "AbaloneTransform", "Type": "Transform", "Arguments": {"ModelName": {"Get": "Steps.AbaloneCreateModel-CreateModel.ModelName"}, "TransformInput": {"DataSource": {"S3DataSource": {"S3DataType": "S3Prefix", "S3Uri": {"Get": "Parameters.BatchData"}}}}, "TransformOutput": {"S3OutputPath": "s3://sagemaker-eu-west-1-885983317836/AbaloneTransform"}, "TransformResources": {"InstanceCount": 1, "InstanceType": "ml.m5.xlarge"}}}], "ElseSteps": [{"Name": "AbaloneMSEFail", "Type": "Fail", "Arguments": {"ErrorMessage": {"Std:Join": {"On": " ", "Values": ["Execution failed due to MSE >", {"Get": "Parameters.MseThreshold"}]}}}}]}}]}, "execution_definition": {"PipelineArn": "arn:aws:sagemaker:eu-west-1:885983317836:pipeline/abalonemlops2pipeline", "PipelineExecutionArn": "arn:aws:sagemaker:eu-west-1:885983317836:pipeline/abalonemlops2pipeline/execution/92jx5a0miarz", "PipelineExecutionDisplayName": "DEV-20221202-210408", "PipelineExecutionStatus": "Succeeded", "PipelineExecutionDescription": "DEV with defaults", "PipelineExperimentConfig": {"ExperimentName": "abalonemlops2pipeline", "TrialName": "92jx5a0miarz"}, "CreationTime": "2022-12-02 21:04:08.207000+00:00", "LastModifiedTime": "2022-12-02 21:19:12.007000+00:00", "CreatedBy": {"UserProfileArn": "arn:aws:sagemaker:eu-west-1:885983317836:user-profile/d-wvfw8wistfxf/sesa681454", "UserProfileName": "sesa681454", "DomainId": "d-wvfw8wistfxf"}, "LastModifiedBy": {"UserProfileArn": "arn:aws:sagemaker:eu-west-1:885983317836:user-profile/d-wvfw8wistfxf/sesa681454", "UserProfileName": "sesa681454", "DomainId": "d-wvfw8wistfxf"}, "ResponseMetadata": {"RequestId": "20750a35-e228-435f-84cb-4150923ba96d", "HTTPStatusCode": 200, "HTTPHeaders": {"x-amzn-requestid": "20750a35-e228-435f-84cb-4150923ba96d", "content-type": "application/x-amz-json-1.1", "content-length": "865", "date": "Fri, 02 Dec 2022 21:19:17 GMT"}, "RetryAttempts": 0}}, "execution_steps": [{"StepName": "AbaloneProcess", "StartTime": "2022-12-02 21:04:09.610000+00:00", "EndTime": "2022-12-02 21:08:10.582000+00:00", "StepStatus": "Succeeded", "AttemptCount": 0, "Metadata": {"ProcessingJob": {"Arn": "arn:aws:sagemaker:eu-west-1:885983317836:processing-job/pipelines-92jx5a0miarz-abaloneprocess-nycbm5carm"}}}, {"StepName": "AbaloneTrain", "StartTime": "2022-12-02 21:08:11.485000+00:00", "EndTime": "2022-12-02 21:10:51.615000+00:00", "StepStatus": "Succeeded", "AttemptCount": 0, "Metadata": {"TrainingJob": {"Arn": "arn:aws:sagemaker:eu-west-1:885983317836:training-job/pipelines-92jx5a0miarz-AbaloneTrain-piWlRdJhMz"}}}, {"StepName": "AbaloneEval", "StartTime": "2022-12-02 21:10:52.195000+00:00", "EndTime": "2022-12-02 21:14:47.142000+00:00", "StepStatus": "Succeeded", "AttemptCount": 0, "Metadata": {"ProcessingJob": {"Arn": "arn:aws:sagemaker:eu-west-1:885983317836:processing-job/pipelines-92jx5a0miarz-abaloneeval-nezmwjj3vs"}}}, {"StepName": "AbaloneMSECond", "StartTime": "2022-12-02 21:14:48.043000+00:00", "EndTime": "2022-12-02 21:14:48.419000+00:00", "StepStatus": "Succeeded", "AttemptCount": 0, "Metadata": {"Condition": {"Outcome": "True"}}}, {"StepName": "AbaloneCreateModel-CreateModel", "StartTime": "2022-12-02 21:14:48.991000+00:00", "EndTime": "2022-12-02 21:14:50.331000+00:00", "StepStatus": "Succeeded", "AttemptCount": 0, "Metadata": {"Model": {"Arn": "arn:aws:sagemaker:eu-west-1:885983317836:model/pipelines-92jx5a0miarz-abalonecreatemodel-c-dgk0smt8u8"}}}, {"StepName": "AbaloneRegisterModel-RegisterModel", "StartTime": "2022-12-02 21:14:48.991000+00:00", "EndTime": "2022-12-02 21:14:50.086000+00:00", "StepStatus": "Succeeded", "AttemptCount": 0, "Metadata": {"RegisterModel": {"Arn": "arn:aws:sagemaker:eu-west-1:885983317836:model-package/abalonemlops2groupname/22"}}}, {"StepName": "AbaloneTransform", "StartTime": "2022-12-02 21:14:50.743000+00:00", "EndTime": "2022-12-02 21:19:11.389000+00:00", "StepStatus": "Succeeded", "AttemptCount": 0, "Metadata": {"TransformJob": {"Arn": "arn:aws:sagemaker:eu-west-1:885983317836:transform-job/pipelines-92jx5a0miarz-AbaloneTransform-VKLCpuc7ue"}}}], "lineage": [{"stepname": "AbaloneProcess", "items": [{"Name/Source": "s3://...21-04-06-122/input/code/preprocessing.py", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "s3://...885983317836/abalone/abalone-dataset.csv", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "14150...om/sagemaker-scikit-learn:0.23-1-cpu-py3", "Direction": "Input", "Type": "Image", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "s3://...cess-2022-12-02-21-04-06-122/output/test", "Direction": "Output", "Type": "DataSet", "Association Type": "Produced", "Lineage Type": "artifact"}, {"Name/Source": "s3://...022-12-02-21-04-06-122/output/validation", "Direction": "Output", "Type": "DataSet", "Association Type": "Produced", "Lineage Type": "artifact"}, {"Name/Source": "s3://...ess-2022-12-02-21-04-06-122/output/train", "Direction": "Output", "Type": "DataSet", "Association Type": "Produced", "Lineage Type": "artifact"}]}, {"stepname": "AbaloneTrain", "items": [{"Name/Source": "s3://...022-12-02-21-04-06-122/output/validation", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "s3://...ess-2022-12-02-21-04-06-122/output/train", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "14150...naws.com/sagemaker-xgboost:1.0-1-cpu-py3", "Direction": "Input", "Type": "Image", "Association Type": "ContributedTo", "Lineage Type": "artifact"}]}, {"stepname": "AbaloneEval", "items": [{"Name/Source": "s3://...02-21-04-07-180/input/code/evaluation.py", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "s3://...cess-2022-12-02-21-04-06-122/output/test", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "s3://...loneTrain-piWlRdJhMz/output/model.tar.gz", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "14150...naws.com/sagemaker-xgboost:1.0-1-cpu-py3", "Direction": "Input", "Type": "Image", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "s3://...022-12-02-21-04-07-180/output/evaluation", "Direction": "Output", "Type": "DataSet", "Association Type": "Produced", "Lineage Type": "artifact"}]}, {"stepname": "AbaloneRegisterModel-RegisterModel", "items": [{"Name/Source": "s3://...loneTrain-piWlRdJhMz/output/model.tar.gz", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "14150...naws.com/sagemaker-xgboost:1.0-1-cpu-py3", "Direction": "Input", "Type": "Image", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "abalonemlops2groupname-22-PendingManualApproval-1670015690-aws-model-package", "Direction": "Input", "Type": "Approval", "Association Type": "ContributedTo", "Lineage Type": "action"}, {"Name/Source": "AbaloneMLOps2GroupName-1669929350-aws-model-package-group", "Direction": "Output", "Type": "ModelGroup", "Association Type": "AssociatedWith", "Lineage Type": "context"}]}, {"stepname": "AbaloneTransform", "items": [{"Name/Source": "s3://...loneTrain-piWlRdJhMz/output/model.tar.gz", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "14150...naws.com/sagemaker-xgboost:1.0-1-cpu-py3", "Direction": "Input", "Type": "Image", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "s3://...5983317836/abalone/abalone-dataset-batch", "Direction": "Input", "Type": "DataSet", "Association Type": "ContributedTo", "Lineage Type": "artifact"}, {"Name/Source": "s3://...-eu-west-1-885983317836/AbaloneTransform", "Direction": "Output", "Type": "DataSet", "Association Type": "Produced", "Lineage Type": "artifact"}]}], "evaluation": {"regression_metrics": {"mse": {"value": 5.147843827056087, "standard_deviation": 2.26875017260822}}}}